(this["webpackJsonptidb-dashboard-ui"]=this["webpackJsonptidb-dashboard-ui"]||[]).push([[10,13],{1547:function(e,t,a){"use strict";a(36),a(543)},1548:function(e,t,a){"use strict";a(36),a(543)},1549:function(e,t,a){"use strict";var n=a(531);t.a=n.a},1550:function(e,t,a){"use strict";var n=a(283);t.a=n.a},1562:function(e,t,a){e.exports={dropdown_content_container:"dropdown_content_container--1LL_-",usual_time_ranges:"usual_time_ranges--11gOY",custom_time_ranges:"custom_time_ranges--36TMv",time_range_items:"time_range_items--2qybk",time_range_item:"time_range_item--2pBU7",time_range_item_active:"time_range_item_active--3qFL_"}},1584:function(e,t,a){"use strict";a.r(t),a.d(t,"StatementsTable",(function(){return ie})),a.d(t,"List",(function(){return Be})),a.d(t,"Detail",(function(){return ce})),a.d(t,"useStatement",(function(){return Pe}));var n=a(0),r=a.n(n),l=a(136),c=a(22),i=a(135),s=(a(1556),a(1566)),m=(a(1557),a(1567)),o=(a(137),a(37)),u=(a(110),a(44)),d=(a(295),a(147)),_=(a(293),a(139)),v=a(1),g=a(11),p=(a(294),a(193)),b=a(21),f=a(1676),y=a(1510),h=a(1509),E=a(1501),x=a(510),O=a(17),j=a(1532),k=(a(542),a(299)),w=a(87),T=a(1494),S=a(1568),C=a(49),M=a(217),I=a(360),q=a(1558),F=a(111),N=a(75),W=a(25),V=a(296),R=a(138);function G(e){return r.a.createElement(i.y.TransKey,{transKey:"statement.fields.".concat(e)})}function K(e,t){return{name:G("digest_text"),key:"digest_text",fieldName:"digest_text",minWidth:100,maxWidth:500,isMultiline:t,onRender:function(e){return t?r.a.createElement(i.z,{multiline:!0},r.a.createElement(i.o,{sql:e.digest_text})):r.a.createElement(u.a,{title:r.a.createElement(i.o,{sql:e.digest_text,theme:"dark"}),placement:"right"},r.a.createElement(i.z,null,r.a.createElement(i.o,{sql:e.digest_text,compact:!0})))}}}function L(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.sum_latency}))))&&void 0!==t?t:0,n="sum_latency";return{name:G(n),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){return r.a.createElement(i.c,{textWidth:70,value:e.sum_latency,capacity:a},Object(R.getValueFormat)("ns")(e.sum_latency,1))}}}function P(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.max_latency}))))&&void 0!==t?t:0,n="avg_latency";return{name:G(n),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){var t="\nMean: ".concat(Object(R.getValueFormat)("ns")(e.avg_latency,1),"\nMin:  ").concat(Object(R.getValueFormat)("ns")(e.min_latency,1),"\nMax:  ").concat(Object(R.getValueFormat)("ns")(e.max_latency,1));return r.a.createElement(u.a,{title:r.a.createElement(i.v,null,t.trim())},r.a.createElement(i.c,{textWidth:70,value:e.avg_latency,max:e.max_latency,min:e.min_latency,capacity:a},Object(R.getValueFormat)("ns")(e.avg_latency,1)))}}}function z(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.exec_count}))))&&void 0!==t?t:0,n="exec_count";return{name:G(n),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){return r.a.createElement(i.c,{textWidth:70,value:e.exec_count,capacity:a},Object(R.getValueFormat)("short")(e.exec_count,0,1))}}}function D(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.max_mem}))))&&void 0!==t?t:0,n="avg_mem";return{name:G(n),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){var t="\nMean: ".concat(Object(R.getValueFormat)("bytes")(e.avg_mem,1),"\nMax:  ").concat(Object(R.getValueFormat)("bytes")(e.max_mem,1));return r.a.createElement(u.a,{title:r.a.createElement(i.v,null,t.trim())},r.a.createElement(i.c,{textWidth:70,value:e.avg_mem,max:e.max_mem,capacity:a},Object(R.getValueFormat)("bytes")(e.avg_mem,1)))}}}function B(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.sum_errors+e.sum_warnings}))))&&void 0!==t?t:0,n="sum_errors";return{name:G("errors_warnings"),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){var t="\nErrors:   ".concat(Object(R.getValueFormat)("short")(e.sum_errors,0,1),"\nWarnings: ").concat(Object(R.getValueFormat)("short")(e.sum_warnings,0,1));return r.a.createElement(u.a,{title:r.a.createElement(i.v,null,t.trim())},r.a.createElement(i.c,{textWidth:70,value:[e.sum_errors,e.sum_warnings],colors:[V.red[4],V.orange[4]],capacity:a},Object(R.getValueFormat)("short")(e.sum_errors,0,1)," / ",Object(R.getValueFormat)("short")(e.sum_warnings,0,1)))}}}function Q(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.max_parse_latency}))))&&void 0!==t?t:0,n="avg_parse_latency";return{name:G("parse_latency"),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){var t="\nMean: ".concat(Object(R.getValueFormat)("ns")(e.avg_parse_latency,1),"\nMax:  ").concat(Object(R.getValueFormat)("ns")(e.max_parse_latency,1));return r.a.createElement(u.a,{title:r.a.createElement(i.v,null,t.trim())},r.a.createElement(i.c,{textWidth:70,value:e.avg_parse_latency,max:e.max_parse_latency,capacity:a},Object(R.getValueFormat)("ns")(e.avg_parse_latency,1)))}}}function A(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.max_compile_latency}))))&&void 0!==t?t:0,n="avg_compile_latency";return{name:G("compile_latency"),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){var t="\nMean: ".concat(Object(R.getValueFormat)("ns")(e.avg_compile_latency,1),"\nMax:  ").concat(Object(R.getValueFormat)("ns")(e.max_compile_latency,1));return r.a.createElement(u.a,{title:r.a.createElement(i.v,null,t.trim())},r.a.createElement(i.c,{textWidth:70,value:e.avg_compile_latency,max:e.max_compile_latency,capacity:a},Object(R.getValueFormat)("ns")(e.avg_compile_latency,1)))}}}function H(e){var t,a=e&&null!==(t=Object(N.max)(e.map((function(e){return e.max_cop_process_time}))))&&void 0!==t?t:0,n="avg_cop_process_time";return{name:G("process_time"),key:n,fieldName:n,minWidth:140,maxWidth:200,columnActionsMode:W.b.clickable,onRender:function(e){var t="\nMean: ".concat(Object(R.getValueFormat)("ns")(e.avg_cop_process_time,1),"\nMax:  ").concat(Object(R.getValueFormat)("ns")(e.max_cop_process_time,1));return r.a.createElement(u.a,{title:r.a.createElement(i.v,null,t.trim())},r.a.createElement(i.c,{textWidth:70,value:e.avg_cop_process_time,max:e.max_cop_process_time,capacity:a},Object(R.getValueFormat)("ns")(e.avg_cop_process_time,1)))}}}var U=a(1529);function J(e){var t=e.data,a=[{key:"table_names",value:r.a.createElement(u.a,{title:t.table_names},r.a.createElement(i.z,null,r.a.createElement(i.v,null,t.table_names)))},{key:"index_names",value:t.index_names},{key:"first_seen",value:t.first_seen&&r.a.createElement(i.k.Calendar,{unixTimestampMs:1e3*t.first_seen})},{key:"last_seen",value:t.last_seen&&r.a.createElement(i.k.Calendar,{unixTimestampMs:1e3*t.last_seen})},{key:"exec_count",value:r.a.createElement(i.x,{value:t.exec_count})},{key:"sum_latency",value:Object(R.getValueFormat)("ns")(t.sum_latency||0,1)},{key:"sample_user",value:t.sample_user},{key:"sum_errors",value:r.a.createElement(i.x,{value:t.sum_errors})},{key:"sum_warnings",value:r.a.createElement(i.x,{value:t.sum_warnings})},{key:"avg_mem",value:Object(R.getValueFormat)("bytes")(t.avg_mem||0,1)},{key:"max_mem",value:Object(R.getValueFormat)("bytes")(t.max_mem||0,1)}],n=Object(U.b)("statement.fields.");return r.a.createElement(i.f,{cardNoMargin:!0,columns:n,items:a,extendLastColumn:!0})}a(540);var Y=a(359);function X(e){var t=e.data,a=Object(x.a)().t,n=[{key:"parse_latency",avg:t.avg_parse_latency,max:t.max_parse_latency},{key:"compile_latency",avg:t.avg_compile_latency,max:t.max_compile_latency},{key:"wait_time",avg:t.avg_wait_time,max:t.max_wait_time},{key:"process_time",avg:t.avg_process_time,max:t.max_process_time},{key:"backoff_time",avg:t.avg_backoff_time,max:t.max_backoff_time},{key:"get_commit_ts_time",avg:t.avg_get_commit_ts_time,max:t.max_get_commit_ts_time},{key:"local_latch_wait_time",avg:t.avg_local_latch_wait_time,max:t.max_local_latch_wait_time},{key:"resolve_lock_time",avg:t.avg_resolve_lock_time,max:t.max_resolve_lock_time},{key:"prewrite_time",avg:t.avg_prewrite_time,max:t.max_prewrite_time},{key:"commit_time",avg:t.avg_commit_time,max:t.max_commit_time},{key:"commit_backoff_time",avg:t.avg_commit_backoff_time,max:t.max_commit_backoff_time},{key:"query_time2",keyDisplay:r.a.createElement(Y.a.Text,{strong:!0},a("statement.fields.query_time2")),avg:t.avg_latency,min:t.min_latency,max:t.max_latency}],l=Object(U.a)("statement.fields.",n);return r.a.createElement(i.f,{cardNoMargin:!0,columns:l,items:n,extendLastColumn:!0})}function Z(e){var t=e.data,a=[{key:"sum_cop_task_num",value:t.sum_cop_task_num},{key:"avg_processed_keys",value:r.a.createElement(i.x,{value:t.avg_processed_keys})},{key:"max_processed_keys",value:r.a.createElement(i.x,{value:t.max_processed_keys})},{key:"avg_total_keys",value:r.a.createElement(i.x,{value:t.avg_total_keys})},{key:"max_total_keys",value:r.a.createElement(i.x,{value:t.max_total_keys})}],n=Object(U.b)("statement.fields.");return r.a.createElement(i.f,{cardNoMargin:!0,columns:n,items:a,extendLastColumn:!0})}function $(e){var t=e.data,a=[{key:"avg_affected_rows",value:r.a.createElement(i.x,{value:t.avg_affected_rows})},{key:"sum_backoff_times",value:r.a.createElement(i.x,{value:t.sum_backoff_times})},{key:"avg_write_keys",value:r.a.createElement(i.x,{value:t.avg_write_keys})},{key:"max_write_keys",value:r.a.createElement(i.x,{value:t.max_write_keys})},{key:"avg_write_size",value:Object(R.getValueFormat)("bytes")(t.avg_write_size||0,1)},{key:"max_write_size",value:Object(R.getValueFormat)("bytes")(t.max_write_size||0,1)},{key:"avg_prewrite_regions",value:r.a.createElement(i.x,{value:t.avg_prewrite_regions})},{key:"max_prewrite_regions",value:r.a.createElement(i.x,{value:t.max_prewrite_regions})},{key:"avg_txn_retry",value:r.a.createElement(i.x,{value:t.avg_txn_retry})},{key:"max_txn_retry",value:r.a.createElement(i.x,{value:t.max_txn_retry})}],n=Object(U.b)("statement.fields.");return r.a.createElement(i.f,{cardNoMargin:!0,columns:n,items:a,extendLastColumn:!0})}var ee=a(1536),te=a(1530),ae=a(1533);function ne(e){var t=e.query,a=Object(te.b)(Object(v.a)(Object(v.a)({},te.a),{},{timeRange:{type:"absolute",value:[t.beginTime,t.endTime]},schemas:[t.schema],limit:100,digest:t.digest,plans:t.plans}),!1),n=a.orderOptions,l=a.changeOrder,c=a.slowQueries,i=a.loadingSlowQueries;return r.a.createElement(ee.a,{cardNoMargin:!0,key:"slow_query_".concat(c.length),loading:i,slowQueries:c,visibleColumnKeys:ae.a,orderBy:n.orderBy,desc:n.desc,onChangeOrder:l})}var re=function(e){var t,a,n=e.query,l=Object(x.a)().t,c=Object(F.b)((function(e){return C.b.getInstance().statementsPlanDetailGet(n.beginTime,n.digest,n.endTime,n.plans,n.schema,{cancelToken:e})})),s=c.data,m=c.isLoading,o=Object(b.i)(!1),u=o.state,d=o.toggle,v=Object(b.i)(!1),g=v.state,p=v.toggle,f=Object(b.i)(!1),y=f.state,h=f.toggle;return a=1===n.allPlans?"one_for_all":n.plans.length===n.allPlans?"all":"some",r.a.createElement(i.e,{title:l("statement.pages.detail.desc.plans.title.".concat(a),{n:n.plans.length})},r.a.createElement(i.a,{showSkeleton:m},s&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.l,null,r.a.createElement(i.l.Item,{span:2,multiline:u,label:r.a.createElement(_.a,{size:"middle"},r.a.createElement(i.y.TransKey,{transKey:"statement.fields.query_sample_text"}),r.a.createElement(i.m.Link,{expanded:u,onClick:function(){return d()}}),r.a.createElement(i.i,{data:Object(I.a)(s.query_sample_text)}))},r.a.createElement(i.m,{expanded:u,collapsedContent:r.a.createElement(i.o,{sql:s.query_sample_text,compact:!0})},r.a.createElement(i.o,{sql:s.query_sample_text}))),s.prev_sample_text?r.a.createElement(i.l.Item,{span:2,multiline:g,label:r.a.createElement(_.a,{size:"middle"},r.a.createElement(i.y.TransKey,{transKey:"statement.fields.prev_sample_text"}),r.a.createElement(i.m.Link,{expanded:g,onClick:function(){return p()}}),r.a.createElement(i.i,{data:Object(I.a)(s.prev_sample_text)}))},r.a.createElement(i.m,{expanded:g,collapsedContent:r.a.createElement(i.o,{sql:s.prev_sample_text,compact:!0})},r.a.createElement(i.o,{sql:s.prev_sample_text}))):null,r.a.createElement(i.l.Item,{span:2,multiline:y,label:r.a.createElement(_.a,{size:"middle"},r.a.createElement(i.y.TransKey,{transKey:"statement.fields.plan"}),r.a.createElement(i.m.Link,{expanded:y,onClick:function(){return h()}}),r.a.createElement(i.i,{data:null!==(t=s.plan)&&void 0!==t?t:""}))},r.a.createElement(i.m,{expanded:y},r.a.createElement(i.v,{noWrap:!0},s.plan)))),r.a.createElement(i.g,{animated:!1},r.a.createElement(i.g.TabPane,{tab:l("statement.pages.detail.tabs.basic"),key:"basic"},r.a.createElement(J,{data:s})),r.a.createElement(i.g.TabPane,{tab:l("statement.pages.detail.tabs.time"),key:"time"},r.a.createElement(X,{data:s})),r.a.createElement(i.g.TabPane,{tab:l("statement.pages.detail.tabs.copr"),key:"copr"},r.a.createElement(Z,{data:s})),r.a.createElement(i.g.TabPane,{tab:l("statement.pages.detail.tabs.txn"),key:"txn"},r.a.createElement($,{data:s})),r.a.createElement(i.g.TabPane,{tab:l("statement.pages.detail.tabs.slow_query"),key:"slow_query"},r.a.createElement(ne,{query:n}))))))};function le(){var e=le.parseQuery(Object(c.g)().search),t=Object(F.b)((function(t){return C.b.getInstance().statementsPlansGet(e.beginTime,e.digest,e.endTime,e.schema,{cancelToken:t})})),a=t.data,s=t.isLoading,m=Object(x.a)().t,o=Object(n.useMemo)((function(){return e=a||[],[{name:G("plan_digest"),key:"plan_digest",fieldName:"plan_digest",minWidth:100,maxWidth:300,onRender:function(e){return r.a.createElement(u.a,{title:e.plan_digest},r.a.createElement(i.z,null,e.plan_digest||"(none)"))}},L(e),P(e),z(e),D(e)];var e}),[a]),d=Object(n.useState)([]),p=Object(g.a)(d,2),f=p[0],y=p[1],h=Object(n.useRef)(new T.a({onSelectionChanged:function(){var e=h.current.getSelection();y(e.map((function(e){return e.plan_digest||""})))}})),E=Object(b.i)(!1),O=E.state,j=E.toggle;return Object(n.useEffect)((function(){a&&a.length>0&&h.current.setAllSelected(!0)}),[a]),r.a.createElement("div",null,r.a.createElement(i.n,{title:m("statement.pages.detail.head.title"),back:r.a.createElement(l.b,{to:"/statement"},r.a.createElement(S.a,null)," ",m("statement.pages.detail.head.back"))},r.a.createElement(i.a,{showSkeleton:s},(!a||0===a.length)&&r.a.createElement(k.a,{message:"Error",type:"error",showIcon:!0}),a&&a.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.l,null,r.a.createElement(i.l.Item,{span:2,multiline:O,label:r.a.createElement(_.a,{size:"middle"},r.a.createElement(i.y.TransKey,{transKey:"statement.fields.digest_text"}),r.a.createElement(i.m.Link,{expanded:O,onClick:function(){return j()}}),r.a.createElement(M.a,{data:Object(I.a)(a[0].digest_text)}))},r.a.createElement(i.m,{expanded:O,collapsedContent:r.a.createElement(i.o,{sql:a[0].digest_text,compact:!0})},r.a.createElement(i.o,{sql:a[0].digest_text}))),r.a.createElement(i.l.Item,{label:r.a.createElement(_.a,{size:"middle"},r.a.createElement(i.y.TransKey,{transKey:"statement.fields.digest"}),r.a.createElement(M.a,{data:a[0].digest}))},a[0].digest),r.a.createElement(i.l.Item,{label:r.a.createElement(i.y.TransKey,{transKey:"statement.pages.detail.desc.time_range"})},r.a.createElement(i.k.Calendar,{unixTimestampMs:1e3*Number(e.beginTime)})," ","~"," ",r.a.createElement(i.k.Calendar,{unixTimestampMs:1e3*Number(e.endTime)})),r.a.createElement(i.l.Item,{label:r.a.createElement(i.y.TransKey,{transKey:"statement.pages.detail.desc.plan_count"})},a.length),r.a.createElement(i.l.Item,{label:r.a.createElement(_.a,{size:"middle"},r.a.createElement(i.y.TransKey,{transKey:"statement.fields.schema_name"}),r.a.createElement(M.a,{data:e.schema}))},e.schema)),r.a.createElement("div",{style:{display:a&&a.length>1?"block":"none"}},r.a.createElement(k.a,{message:m("statement.pages.detail.desc.plans.note"),type:"info",showIcon:!0}),r.a.createElement(i.f,{cardNoMargin:!0,columns:o,items:a,selectionMode:w.b.multiple,selection:h.current,selectionPreservedOnEmptyClick:!0}))))),f.length>0&&a&&a.length>0&&r.a.createElement(re,{query:Object(v.a)(Object(v.a)({},e),{},{plans:f,allPlans:a.length}),key:JSON.stringify(f)}))}le.buildQuery=Object(q.a)(),le.parseQuery=Object(q.b)();var ce=le;function ie(e){var t=e.loading,a=e.statements,l=e.timeRange,s=e.showFullSQL,m=e.onGetColumns,o=Object(O.a)(e,["loading","statements","timeRange","showFullSQL","onGetColumns"]),d=Object(c.h)(),_=Object(n.useMemo)((function(){return function(e,t){return[K(0,t),L(e),P(e),z(e),D(e),B(e),Q(e),A(e),H(e),{name:G("related_schemas"),key:"related_schemas",minWidth:160,maxWidth:240,onRender:function(e){return r.a.createElement(u.a,{title:e.related_schemas},r.a.createElement(i.z,null,e.related_schemas))}}]}(a,s)}),[a,s]);Object(n.useEffect)((function(){m&&m(_||[])}),[m,_]);var v=Object(b.f)((function(e,t,a){var n=ce.buildQuery({digest:e.digest,schema:e.schema_name,beginTime:l.begin_time,endTime:l.end_time});Object(j.a)("/statement/detail?".concat(n),a,d)})),g=Object(n.useCallback)((function(e){return"".concat(e.digest,"_").concat(e.schema_name)}),[]);return r.a.createElement(i.f,Object.assign({},o,{loading:t,columns:_,items:a,onRowClicked:v,getKey:g}))}a(1539);var se=a(1541),me=a(23),oe=(a(1560),a(1569)),ue=(a(538),a(142)),de=(a(1540),a(1543)),_e=(a(544),a(364)),ve=(a(537),a(358)),ge=a(32),pe=a.n(ge),be=a(66),fe=a(1665),ye=function(e){return e.reduce((function(e,t){return e[t]=t,e}),{})},he=ye([1,5,15,30,60]),Ee=ye([1,2,5,10,20,30]);var xe=function(e){var t=e.onClose,a=e.onConfigUpdated,l=Object(n.useState)(!1),c=Object(g.a)(l,2),i=c[0],s=c[1],m=Object(n.useState)(!1),u=Object(g.a)(m,2),d=u[0],b=u[1],f=Object(n.useState)(null),y=Object(g.a)(f,2),h=y[0],E=y[1],O=Object(n.useState)(null),j=Object(g.a)(O,2),k=j[0],w=j[1],T=Object(x.a)().t;function S(e){return M.apply(this,arguments)}function M(){return(M=Object(be.a)(pe.a.mark((function e(n){var r,l;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),r={enable:n.enable,refresh_interval:60*n.refresh_interval,history_size:Math.ceil(24*n.keep_duration*60/n.refresh_interval)},e.next=4,C.b.getInstance().statementsConfigPost(r);case 4:l=e.sent,b(!1),l&&(t(),a());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){function e(){return(e=Object(be.a)(pe.a.mark((function e(){var t,a,n,r,l,c;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,C.b.getInstance().statementsConfigGet();case 3:(null===(t=e.sent)||void 0===t?void 0:t.data)&&(a=t.data,E(a),n=Math.ceil(a.refresh_interval/60),r=Math.max(n,60),l=Math.ceil(a.refresh_interval*a.history_size/86400),c=Math.max(l,30),w(Object(v.a)(Object(v.a)({},a),{},{refresh_interval:n,keep_duration:l,max_refresh_interval:r,max_keep_duration:c}))),s(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),r.a.createElement(r.a.Fragment,null,i&&r.a.createElement(_e.a,{active:!0,paragraph:{rows:5}}),!i&&k&&r.a.createElement(ue.a,{layout:"vertical",initialValues:k,onFinish:function(e){(null===h||void 0===h?void 0:h.enable)&&!e.enable?ve.a.confirm({title:T("statement.settings.close_statement"),icon:r.a.createElement(fe.a,null),content:T("statement.settings.close_statement_warning"),okText:T("statement.settings.actions.close"),cancelText:T("statement.settings.actions.cancel"),okButtonProps:{danger:!0},onOk:function(){return S(e)}}):S(e)}},r.a.createElement(ue.a.Item,{name:"enable",valuePropName:"checked",label:T("statement.settings.switch")},r.a.createElement(de.a,null)),r.a.createElement(ue.a.Item,{noStyle:!0,shouldUpdate:function(e,t){return e.enable!==t.enable}},(function(e){return(0,e.getFieldValue)("enable")&&r.a.createElement(ue.a.Item,{noStyle:!0},r.a.createElement(ue.a.Item,{label:T("statement.settings.refresh_interval")},r.a.createElement(p.a.Group,null,r.a.createElement(ue.a.Item,{noStyle:!0,name:"refresh_interval"},r.a.createElement(oe.a,{min:1,max:k.max_refresh_interval,formatter:function(e){return"".concat(e," min")},parser:function(e){return(null===e||void 0===e?void 0:e.replace(/[^\d]/g,""))||""}})),r.a.createElement(ue.a.Item,{noStyle:!0,name:"refresh_interval"},r.a.createElement(se.a,{min:1,max:k.max_refresh_interval,marks:Object(v.a)(Object(v.a)({},he),{},Object(me.a)({},k.max_refresh_interval,"".concat(k.max_refresh_interval)))})))),r.a.createElement(ue.a.Item,{label:T("statement.settings.keep_duration")},r.a.createElement(p.a.Group,null,r.a.createElement(ue.a.Item,{noStyle:!0,name:"keep_duration"},r.a.createElement(oe.a,{min:1,max:k.max_keep_duration,formatter:function(e){return"".concat(e," day")},parser:function(e){return(null===e||void 0===e?void 0:e.replace(/[^\d]/g,""))||""}})),r.a.createElement(ue.a.Item,{noStyle:!0,name:"keep_duration"},r.a.createElement(se.a,{min:1,max:k.max_keep_duration,marks:Object(v.a)(Object(v.a)({},Ee),{},Object(me.a)({},k.max_keep_duration,"".concat(k.max_keep_duration)))})))))})),r.a.createElement(ue.a.Item,null,r.a.createElement(_.a,null,r.a.createElement(o.a,{type:"primary",htmlType:"submit",loading:d},T("statement.settings.actions.save")),r.a.createElement(o.a,{onClick:t},T("statement.settings.actions.cancel"))))))},Oe=(a(361),a(221)),je=a(1511),ke=a(1506),we=a(4),Te=a.n(we),Se=a(38),Ce=a.n(Se),Me=a(1562),Ie=a.n(Me),qe=[900,1800,3600,7200,21600,43200,86400,172800,259200,604800,1209600,2419200];function Fe(e,t){if(0===t.length)return e;if(1===t.length)return t[0];for(var a=t[0],n=0;n<t.length;n++)if(!((a=t[n])>e)){if(0===n)return a;var r=t[n-1];return r-e<e-a?r:a}return a}function Ne(e){var t=e.map((function(e){return e.begin_time})),a=e.map((function(e){return e.end_time}));return{allBeginTime:t,allEndTime:a,minBeginTime:t[t.length-1]||0,maxBeginTime:t[0]||0,maxEndTime:a[0]||0}}function We(e,t){var a=Ne(t),n=a.allBeginTime,r=a.allEndTime,l=a.maxEndTime;return"recent"===e.type?{begin_time:Fe(l-e.value,n),end_time:l}:{begin_time:Fe(e.value[0],n),end_time:Fe(e.value[1],r)}}function Ve(e){var t=e.value,a=e.timeRanges,l=e.onChange,c=Object(x.a)().t,i=Object(n.useMemo)((function(){return Ne(a)}),[a]),s=i.minBeginTime,m=i.maxEndTime,u=Object(n.useState)((function(){return We(t,a)})),d=Object(g.a)(u,2),_=d[0],v=d[1],p=Object(n.useState)(!1),b=Object(g.a)(p,2),f=b[0],y=b[1];Object(n.useEffect)((function(){v(We(t,a))}),[t,a]);var h=r.a.createElement("div",{className:Ie.a.dropdown_content_container},r.a.createElement("div",{className:Ie.a.usual_time_ranges},r.a.createElement("span",null,c("statement.pages.overview.toolbar.time_range_selector.usual_time_ranges")),r.a.createElement("div",{className:Ie.a.time_range_items},qe.map((function(e){return r.a.createElement("div",{tabIndex:-1,key:e,className:Te()(Ie.a.time_range_item,Object(me.a)({},Ie.a.time_range_item_active,"recent"===t.type&&t.value===e)),onClick:function(){return function(e){var t={type:"recent",value:e};l(t),v(We(t,a)),y(!1)}(e)}},c("statement.pages.overview.toolbar.time_range_selector.recent")," ",Object(R.getValueFormat)("s")(e,0))})))),r.a.createElement("div",{className:Ie.a.custom_time_ranges},r.a.createElement("span",null,c("statement.pages.overview.toolbar.time_range_selector.custom_time_ranges")),r.a.createElement(se.a,{min:s,max:m,step:60,range:!0,value:[_.begin_time,_.end_time],onChange:function(e){0===e[0]&&0===e[1]||v(We({type:"absolute",value:e},a))},onAfterChange:function(e){l({type:"absolute",value:e})},tipFormatter:function(e){return Ce.a.unix(e).format("HH:mm")}}),r.a.createElement("span",null,Ce.a.unix(_.begin_time).format("MM-DD HH:mm")," ~"," ",Ce.a.unix(_.end_time).format("MM-DD HH:mm"))));return r.a.createElement(Oe.a,{disabled:0===a.length,overlay:h,trigger:["click"],visible:f,onVisibleChange:y},r.a.createElement(o.a,{icon:r.a.createElement(je.a,null)},"recent"===t.type?r.a.createElement("span",null,c("statement.pages.overview.toolbar.time_range_selector.recent")," ",Object(R.getValueFormat)("s")(t.value,0)):r.a.createElement("span",null,Ce.a.unix(_.begin_time).format("MM-DD HH:mm")," ~"," ",Ce.a.unix(_.end_time).format("MM-DD HH:mm")),r.a.createElement(ke.a,null)))}var Re=a(94),Ge=a(1559),Ke={orderBy:"sum_latency",desc:!0},Le={timeRange:{type:"recent",value:1800},schemas:[],stmtTypes:[],searchText:""};function Pe(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=Object(Ge.a)("statement",t,Ke),r=a.orderOptions,l=a.changeOrder,c=Object(n.useState)(e||Le),i=Object(g.a)(c,2),s=i[0],m=i[1],o=Object(b.g)("statement.query_options",e||Le),u=Object(g.a)(o,2),d=u[0],_=u[1],p=Object(n.useMemo)((function(){return t?d:s}),[t,s,d]),f=Object(n.useState)(!0),y=Object(g.a)(f,2),h=y[0],E=y[1],x=Object(n.useState)([]),O=Object(g.a)(x,2),j=O[0],k=O[1],w=Object(n.useState)([]),T=Object(g.a)(w,2),S=T[0],M=T[1],I=Object(n.useState)([]),q=Object(g.a)(I,2),F=q[0],N=q[1],W=Object(n.useMemo)((function(){return We(p.timeRange,j)}),[p,j]),V=Object(n.useState)(!0),R=Object(g.a)(V,2),G=R[0],K=R[1],L=Object(n.useState)([]),P=Object(g.a)(L,2),z=P[0],D=P[1],B=Object(n.useState)(0),Q=Object(g.a)(B,2),A=Q[0],H=Q[1];function U(e){t?_(e):m(e)}var J=Object(n.useState)([]),Y=Object(g.a)(J,2),X=Y[0],Z=Y[1];function $(){Z([]),H((function(e){return e+1}))}return Object(n.useEffect)((function(){function e(){return(e=Object(be.a)(pe.a.mark((function e(){var t;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.b.getInstance().statementsConfigGet();case 3:t=e.sent,E(null===t||void 0===t?void 0:t.data.enable),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Z((function(t){return[].concat(Object(Re.a)(t),[Object(v.a)({},e.t0)])}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function t(){return(t=Object(be.a)(pe.a.mark((function e(){var t;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.b.getInstance().infoDatabasesGet();case 3:t=e.sent,M((null===t||void 0===t?void 0:t.data)||[]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Z((function(t){return[].concat(Object(Re.a)(t),[Object(v.a)({},e.t0)])}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function a(){return(a=Object(be.a)(pe.a.mark((function e(){var t;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.b.getInstance().statementsTimeRangesGet();case 3:t=e.sent,k((null===t||void 0===t?void 0:t.data)||[]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Z((function(t){return[].concat(Object(Re.a)(t),[Object(v.a)({},e.t0)])}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function n(){return(n=Object(be.a)(pe.a.mark((function e(){var t;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.b.getInstance().statementsStmtTypesGet();case 3:t=e.sent,N((null===t||void 0===t?void 0:t.data)||[]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Z((function(t){return[].concat(Object(Re.a)(t),[Object(v.a)({},e.t0)])}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}(),function(){a.apply(this,arguments)}(),function(){n.apply(this,arguments)}()}),[A]),Object(n.useEffect)((function(){function e(){return(e=Object(be.a)(pe.a.mark((function e(){var t;return pe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==j.length){e.next=4;break}return D([]),K(!1),e.abrupt("return");case 4:return K(!0),e.prev=5,e.next=8,C.b.getInstance().statementsOverviewsGet(W.begin_time,W.end_time,p.schemas,p.stmtTypes,p.searchText);case 8:t=e.sent,D((null===t||void 0===t?void 0:t.data)||[]),Z([]),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),Z((function(t){return[].concat(Object(Re.a)(t),[Object(v.a)({},e.t0)])}));case 16:K(!1);case 17:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[p,j,W]),{queryOptions:p,setQueryOptions:U,orderOptions:r,changeOrder:l,refresh:$,enable:h,allTimeRanges:j,allSchemas:S,allStmtTypes:F,validTimeRange:W,loadingStatements:G,statements:z,errors:X}}var ze=p.a.Search,De={digest_text:!0,sum_latency:!0,avg_latency:!0,exec_count:!0,avg_mem:!0,related_schemas:!0};function Be(){var e=Object(x.a)().t,t=Pe(),a=t.queryOptions,l=t.setQueryOptions,c=t.orderOptions,p=t.changeOrder,O=t.refresh,j=t.enable,k=t.allTimeRanges,w=t.allSchemas,T=t.allStmtTypes,S=t.validTimeRange,C=t.loadingStatements,M=t.statements,I=t.errors,q=Object(n.useState)([]),F=Object(g.a)(q,2),N=F[0],W=F[1],V=Object(n.useState)(!1),R=Object(g.a)(V,2),G=R[0],K=R[1],L=Object(b.d)("statement.visible_column_keys",De),P=Object(g.a)(L,2),z=P[0],D=P[1],B=Object(b.d)("statement.show_full_sql",!1),Q=Object(g.a)(B,2),A=Q[0],H=Q[1];return r.a.createElement("div",{style:{height:"100vh",display:"flex",flexDirection:"column"}},r.a.createElement(i.e,null,r.a.createElement(i.B,null,r.a.createElement(_.a,null,r.a.createElement(Ve,{value:a.timeRange,timeRanges:k,onChange:function(e){return l(Object(v.a)(Object(v.a)({},a),{},{timeRange:e}))}}),r.a.createElement(i.t.Plain,{placeholder:e("statement.pages.overview.toolbar.schemas.placeholder"),selectedValueTransKey:"statement.pages.overview.toolbar.schemas.selected",columnTitle:e("statement.pages.overview.toolbar.schemas.columnTitle"),value:a.schemas,style:{width:150},onChange:function(e){return l(Object(v.a)(Object(v.a)({},a),{},{schemas:e}))},items:w}),r.a.createElement(i.t.Plain,{placeholder:e("statement.pages.overview.toolbar.statement_types.placeholder"),selectedValueTransKey:"statement.pages.overview.toolbar.statement_types.selected",columnTitle:e("statement.pages.overview.toolbar.statement_types.columnTitle"),value:a.stmtTypes,style:{width:150},onChange:function(e){return l(Object(v.a)(Object(v.a)({},a),{},{stmtTypes:e}))},items:T}),r.a.createElement(ze,{defaultValue:a.searchText,onSearch:function(e){return l(Object(v.a)(Object(v.a)({},a),{},{searchText:e}))}})),r.a.createElement(_.a,null,N.length>0&&r.a.createElement(i.h,{columns:N,visibleColumnKeys:z,resetColumnKeys:De,onChange:D,foot:r.a.createElement(d.a,{checked:A,onChange:function(e){return H(e.target.checked)}},e("statement.pages.overview.toolbar.select_columns.show_full_sql"))}),r.a.createElement(u.a,{title:e("statement.settings.title")},r.a.createElement(f.a,{onClick:function(){return K(!0)}})),r.a.createElement(u.a,{title:e("statement.pages.overview.toolbar.refresh")},C?r.a.createElement(y.a,null):r.a.createElement(h.a,{onClick:O}))))),j?r.a.createElement("div",{style:{height:"100%",position:"relative"}},r.a.createElement(E.a,null,r.a.createElement(ie,{cardNoMarginTop:!0,loading:C,errors:I,statements:M,timeRange:S,orderBy:c.orderBy,desc:c.desc,showFullSQL:A,visibleColumnKeys:z,onGetColumns:W,onChangeOrder:p}))):r.a.createElement(m.a,{title:e("statement.settings.disabled_result.title"),subTitle:e("statement.settings.disabled_result.sub_title"),extra:r.a.createElement(o.a,{type:"primary",onClick:function(){return K(!0)}},e("statement.settings.open_setting"))}),r.a.createElement(s.a,{title:e("statement.settings.title"),width:300,closable:!0,visible:G,onClose:function(){return K(!1)},destroyOnClose:!0},r.a.createElement(xe,{onClose:function(){return K(!1)},onConfigUpdated:O})))}t.default=function(){return r.a.createElement(i.w,null,r.a.createElement(l.a,null,r.a.createElement(c.d,null,r.a.createElement(c.b,{path:"/statement",element:r.a.createElement(Be,null)}),r.a.createElement(c.b,{path:"/statement/detail",element:r.a.createElement(ce,null)}))))}},1587:function(e,t,a){"use strict";a.r(t),a.d(t,"SlowQueriesTable",(function(){return u.a})),a.d(t,"List",(function(){return s.b})),a.d(t,"Detail",(function(){return m.a})),a.d(t,"useSlowQuery",(function(){return o.b}));var n=a(0),r=a.n(n),l=a(135),c=a(136),i=a(22),s=a(1533),m=a(1542),o=a(1530),u=a(1536);t.default=function(){return r.a.createElement(l.w,null,r.a.createElement(c.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/slow_query",element:r.a.createElement(s.b,null)}),r.a.createElement(i.b,{path:"/slow_query/detail",element:r.a.createElement(m.a,null)}))))}},1609:function(e,t,a){e.exports={big:"big--2HHu7"}},1668:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return le}));a(1547);var n=a(1549),r=(a(1548),a(1550)),l=a(0),c=a.n(l),i=a(510),s=a(136),m=a(135),o=(a(540),a(359)),u=(a(293),a(139)),d=a(32),_=a.n(d),v=a(66),g=a(11),p=a(1507),b=a(1505),f=a(49),y=a(111),h=a(3),E=a(1471),x=a(190),O=a(357),j=h.a;function k(e,t){for(var a=[],n=2;n<arguments.length;n++)a[n-2]=arguments[n];var r=e;if(r.isSlot){var c=l.Children.count(a);return 0===c?r(t):(a=l.Children.toArray(a),r(Object(h.a)(Object(h.a)({},t),{children:a})))}return l.createElement.apply(l,Object(h.e)([e,t],a))}function w(e,t){void 0===t&&(t={});var a=t.defaultProp,n=void 0===a?"children":a;return function(t,a,r,c,i){if(l.isValidElement(a))return a;var s=function(e,t){for(var a=[],n=2;n<arguments.length;n++)a[n-2]=arguments[n];for(var r={},l=[],c=0,i=a;c<i.length;c++){var s=i[c];l.push(s&&s.className),j(r,s)}return r.className=Object(E.a)([e,l],{rtl:Object(O.a)(t)}),r}(c,i,t,function(e,t){var a,n;"string"===typeof t||"number"===typeof t||"boolean"===typeof t?((a={})[e]=t,n=a):n=t;return n}(n,a));if(r){if(r.component){var m=r.component;return l.createElement(m,Object(h.a)({},s))}if(r.render)return r.render(s,e)}return l.createElement(e,Object(h.a)({},s))}}var T=Object(x.b)((function(e){return w(e)}));function S(e,t){var a={},n=e,r=function(e){if(t.hasOwnProperty(e)){var r=function(a){for(var r=[],l=1;l<arguments.length;l++)r[l-1]=arguments[l];if(r.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return C(t[e],a,n[e],n.slots&&n.slots[e],n._defaultStyles&&n._defaultStyles[e],n.theme)};r.isSlot=!0,a[e]=r}};for(var l in t)r(l);return a}function C(e,t,a,n,r,l){return void 0!==e.create?e.create(t,a,n,r):T(e)(t,a,n,r,l)}var M=a(14),I=a(151),q=a(89);function F(e,t){void 0===t&&(t={});var a=t.factoryOptions,n=(void 0===a?{}:a).defaultProp,r=function(a){var n,r,c,i=(n=t.displayName,r=l.useContext(I.a),c=t.fields,q.a.getSettings(c||["theme","styles","tokens"],n,r.customizations)),s=t.state;s&&(a=Object(h.a)(Object(h.a)({},a),s(a)));var m=a.theme||i.theme,o=function e(t,a){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var l={},c=0,i=n;c<i.length;c++){var s=i[c];s&&(s="function"===typeof s?s(t,a):s,Array.isArray(s)&&(s=e.apply(void 0,Object(h.e)([t,a],s))),j(l,s))}return l}(a,m,t.tokens,i.tokens,a.tokens),u=function(e,t,a){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r];return M.j.apply(void 0,n.map((function(n){return"function"===typeof n?n(e,t,a):n})))}(a,m,o,t.styles,i.styles,a.styles),d=Object(h.a)(Object(h.a)({},a),{styles:u,tokens:o,_defaultStyles:u,theme:m});return e(d)};return r.displayName=t.displayName||e.name,n&&(r.create=w(r,{defaultProp:n})),j(r,t.statics),r}var N=a(536),W=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},V=function(e){var t=parseFloat(e),a=isNaN(t)?0:t,n=isNaN(t)?"":t.toString();return{value:a,unit:e.substring(n.toString().length)||"px"}},R=function(e,t){if(void 0===e||"number"===typeof e||""===e)return e;var a=e.split(" ");return a.length<2?W(e,t):a.reduce((function(e,a){return W(e,t)+" "+W(a,t)}))},G={start:"flex-start",end:"flex-end"},K={root:"ms-Stack",inner:"ms-Stack-inner"},L={root:"ms-StackItem"},P={start:"flex-start",end:"flex-end"},z=F((function(e){var t=e.children;return l.Children.count(t)<1?null:k(S(e,{root:"div"}).root,null,t)}),{displayName:"StackItem",styles:function(e,t,a){var n=e.grow,r=e.shrink,l=e.disableShrink,c=e.align,i=e.verticalFill,s=e.order,m=e.className,o=Object(M.n)(L,t);return{root:[t.fonts.medium,o.root,{margin:a.margin,height:i?"100%":"auto",width:"auto"},n&&{flexGrow:!0===n?1:n},(l||!n&&!r)&&{flexShrink:0},r&&!l&&{flexShrink:1},c&&{alignSelf:P[c]||c},s&&{order:s},m]}}});var D=F((function(e){var t=e.as,a=void 0===t?"div":t,n=e.disableShrink,r=e.wrap,c=Object(h.d)(e,["as","disableShrink","wrap"]),i=l.Children.map(e.children,(function(e,t){if(!e)return null;if((r=e)&&"object"===typeof r&&r.type&&r.type.displayName===z.displayName){var a={shrink:!n};return l.cloneElement(e,Object(h.a)(Object(h.a)({},a),e.props))}var r;return e})),s=Object(N.b)(c,N.c),m=S(e,{root:a,inner:"div"});return k(m.root,Object(h.a)({},s),r?k(m.inner,null,i):i)}),{displayName:"Stack",styles:function(e,t,a){var n,r,l,c,i,s,m,o=e.verticalFill,u=e.horizontal,d=e.reversed,_=e.grow,v=e.wrap,g=e.horizontalAlign,p=e.verticalAlign,b=e.disableShrink,f=e.className,y=Object(M.n)(K,t),E=a&&a.childrenGap?a.childrenGap:e.gap,x=a&&a.maxHeight?a.maxHeight:e.maxHeight,O=a&&a.maxWidth?a.maxWidth:e.maxWidth,j=a&&a.padding?a.padding:e.padding,k=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"===typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var a=e.split(" ");if(a.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===a.length)return{rowGap:V(W(a[0],t)),columnGap:V(W(a[1],t))};var n=V(W(e,t));return{rowGap:n,columnGap:n}}(E,t),w=k.rowGap,T=k.columnGap,S=""+-.5*T.value+T.unit,C=""+-.5*w.value+w.unit,I={textOverflow:"ellipsis"},q={"> *:not(.ms-StackItem)":{flexShrink:b?0:1}};return v?{root:[y.root,{flexWrap:"wrap",maxWidth:O,maxHeight:x,width:"auto",overflow:"visible",height:"100%"},g&&(n={},n[u?"justifyContent":"alignItems"]=G[g]||g,n),p&&(r={},r[u?"alignItems":"justifyContent"]=G[p]||p,r),f,{display:"flex"},u&&{height:o?"100%":"auto"}],inner:[y.inner,{display:"flex",flexWrap:"wrap",marginLeft:S,marginRight:S,marginTop:C,marginBottom:C,overflow:"visible",boxSizing:"border-box",padding:R(j,t),width:0===T.value?"100%":"calc(100% + "+T.value+T.unit+")",maxWidth:"100vw",selectors:Object(h.a)({"> *":Object(h.a)({margin:""+.5*w.value+w.unit+" "+.5*T.value+T.unit},I)},q)},g&&(l={},l[u?"justifyContent":"alignItems"]=G[g]||g,l),p&&(c={},c[u?"alignItems":"justifyContent"]=G[p]||p,c),u&&{flexDirection:d?"row-reverse":"row",height:0===w.value?"100%":"calc(100% + "+w.value+w.unit+")",selectors:{"> *":{maxWidth:0===T.value?"100%":"calc(100% - "+T.value+T.unit+")"}}},!u&&{flexDirection:d?"column-reverse":"column",height:"calc(100% + "+w.value+w.unit+")",selectors:{"> *":{maxHeight:0===w.value?"100%":"calc(100% - "+w.value+w.unit+")"}}}]}:{root:[y.root,{display:"flex",flexDirection:u?d?"row-reverse":"row":d?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:o?"100%":"auto",maxWidth:O,maxHeight:x,padding:R(j,t),boxSizing:"border-box",selectors:Object(h.a)((i={"> *":I},i[d?"> *:not(:last-child)":"> *:not(:first-child)"]=[u&&{marginLeft:""+T.value+T.unit},!u&&{marginTop:""+w.value+w.unit}],i),q)},_&&{flexGrow:!0===_?1:_},g&&(s={},s[u?"justifyContent":"alignItems"]=G[g]||g,s),p&&(m={},m[u?"alignItems":"justifyContent"]=G[p]||p,m),f]}},statics:{Item:z}});function B(){var e=Object(i.a)().t,t=Object(l.useState)(0),a=Object(g.a)(t,2),n=a[0],r=a[1],d=Object(y.b)((function(e){return f.b.getInstance().getAlertManagerTopology({cancelToken:e})})),h=d.data,E=d.isLoading,x=Object(y.b)((function(e){return f.b.getInstance().getGrafanaTopology({cancelToken:e})})),O=x.data,j=x.isLoading;return Object(l.useEffect)((function(){function e(){return(e=Object(v.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.b.getInstance().getAlertManagerCounts("".concat(h.ip,":").concat(h.port));case 2:t=e.sent,r(t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}h&&function(){e.apply(this,arguments)}()}),[h]),c.a.createElement(m.e,{title:e("overview.monitor_alert.title"),noMarginLeft:!0},c.a.createElement(D,{gap:16},c.a.createElement(m.a,{showSkeleton:j,paragraph:{rows:1}},!O&&c.a.createElement(o.a.Text,{type:"warning"},c.a.createElement(u.a,null,c.a.createElement(p.a,null),e("overview.monitor_alert.view_monitor_warn"))),O&&c.a.createElement("a",{href:"http://".concat(O.ip,":").concat(O.port)},c.a.createElement(u.a,null,e("overview.monitor_alert.view_monitor"),c.a.createElement(b.a,null)))),c.a.createElement(m.a,{showSkeleton:E,paragraph:{rows:1}},!h&&c.a.createElement(o.a.Text,{type:"warning"},c.a.createElement(u.a,null,c.a.createElement(p.a,null),e("overview.monitor_alert.view_alerts_warn"))),h&&c.a.createElement("a",{href:"http://".concat(h.ip,":").concat(h.port)},c.a.createElement(u.a,null,c.a.createElement(o.a.Text,{type:n>0?"danger":void 0},0===n?e("overview.monitor_alert.view_zero_alerts"):e("overview.monitor_alert.view_alerts",{alertCount:n})),c.a.createElement(b.a,null)))),c.a.createElement("div",null,c.a.createElement(s.b,{to:"/diagnose"},c.a.createElement(u.a,null,e("overview.monitor_alert.run_diagnose"),c.a.createElement(b.a,null))))))}var Q=a(1),A=a(39),H=a(1609),U=a.n(H);function J(e){var t=e.name,a=e.resp,n=Object(l.useMemo)((function(){if(!a.data)return[0,0];var e,t=0,n=0,r=Object(A.a)(a.data);try{for(r.s();!(e=r.n()).done;){var l=e.value;n++,1!==l.status&&2!==l.status&&3!==l.status||t++}}catch(c){r.e(c)}finally{r.f()}return[t,n]}),[a]),r=Object(g.a)(n,2),i=r[0],s=r[1];return c.a.createElement(m.a,{showSkeleton:a.isLoading,paragraph:{rows:1}},!a.error&&c.a.createElement(m.l,{column:1},c.a.createElement(m.l.Item,{label:t},c.a.createElement(o.a.Text,{type:i===s?void 0:"danger"},c.a.createElement("span",{className:U.a.big},i),c.a.createElement("small",null," / ",s)))),a.error&&c.a.createElement(o.a.Text,{type:"danger"},c.a.createElement(u.a,null,c.a.createElement(p.a,null)," Error")))}function Y(){var e,t,a=Object(i.a)().t,l=Object(y.b)((function(e){return f.b.getInstance().getTiDBTopology({cancelToken:e})})),o=Object(y.b)((function(e){return f.b.getInstance().getStoreTopology({cancelToken:e})})),u=Object(Q.a)(Object(Q.a)({},o),{},{data:null===(e=o.data)||void 0===e?void 0:e.tikv}),d=Object(Q.a)(Object(Q.a)({},o),{},{data:null===(t=o.data)||void 0===t?void 0:t.tiflash}),_=Object(y.b)((function(e){return f.b.getInstance().getPDTopology({cancelToken:e})}));return c.a.createElement(m.e,{title:c.a.createElement(s.b,{to:"/cluster_info"},a("overview.instances.title"),c.a.createElement(b.a,null)),noMarginLeft:!0},c.a.createElement(D,{gap:16},c.a.createElement(n.a,null,c.a.createElement(r.a,{span:12},c.a.createElement(J,{name:"PD",resp:_})),c.a.createElement(r.a,{span:12},c.a.createElement(J,{name:"TiDB",resp:l}))),c.a.createElement(n.a,null,c.a.createElement(r.a,{span:12},c.a.createElement(J,{name:"TiKV",resp:u})),c.a.createElement(r.a,{span:12},c.a.createElement(J,{name:"TiFlash",resp:d})))))}var X=a(1584);function Z(){var e,t,a=Object(i.a)().t,n=Object(X.useStatement)(void 0,!1),r=n.orderOptions,l=n.changeOrder,o=n.allTimeRanges,u=n.validTimeRange,d=n.loadingStatements,_=n.statements,v=n.errors;return c.a.createElement(X.StatementsTable,{key:"statement_".concat(_.length),visibleColumnKeys:{digest_text:!0,sum_latency:!0,avg_latency:!0,related_schemas:!0},visibleItemsCount:10,loading:d,statements:_,timeRange:u,orderBy:r.orderBy,desc:r.desc,onChangeOrder:l,errors:v,title:c.a.createElement(s.b,{to:"/statement"},a("overview.top_statements.title")," ",c.a.createElement(b.a,null)),subTitle:o.length>0&&c.a.createElement("span",null,c.a.createElement(m.k.Calendar,{unixTimestampMs:1e3*(null!==(e=u.begin_time)&&void 0!==e?e:0)})," ","~"," ",c.a.createElement(m.k.Calendar,{unixTimestampMs:1e3*(null!==(t=u.end_time)&&void 0!==t?t:0)}))})}var $=a(1587),ee=a(1533),te=a(1530);function ae(){var e=Object(i.a)().t,t=Object($.useSlowQuery)(Object(Q.a)(Object(Q.a)({},te.a),{},{limit:10}),!1),a=t.orderOptions,n=t.changeOrder,r=t.loadingSlowQueries,l=t.slowQueries,o=t.queryTimeRange,u=t.errors;return c.a.createElement($.SlowQueriesTable,{key:"slow_query_".concat(l.length),visibleColumnKeys:ee.a,loading:r,slowQueries:l,orderBy:a.orderBy,desc:a.desc,onChangeOrder:n,errors:u,title:c.a.createElement(s.b,{to:"/slow_query"},e("overview.recent_slow_query.title")," ",c.a.createElement(b.a,null)),subTitle:c.a.createElement("span",null,c.a.createElement(m.k.Calendar,{unixTimestampMs:1e3*o.beginTime})," ","~"," ",c.a.createElement(m.k.Calendar,{unixTimestampMs:1e3*o.endTime}))})}function ne(){var e=Object(i.a)().t;return c.a.createElement(m.s,{title:e("overview.metrics.total_requests"),series:[{query:"sum(rate(tidb_server_query_total[1m])) by (result)",name:"Queries {result}"}],unit:"ops",type:"bar"})}function re(){var e=Object(i.a)().t;return c.a.createElement(m.s,{title:e("overview.metrics.latency"),series:[{query:"histogram_quantile(0.999, sum(rate(tidb_server_handle_query_duration_seconds_bucket[1m])) by (le))",name:"99.9%"},{query:"histogram_quantile(0.99, sum(rate(tidb_server_handle_query_duration_seconds_bucket[1m])) by (le))",name:"99%"},{query:"histogram_quantile(0.9, sum(rate(tidb_server_handle_query_duration_seconds_bucket[1m])) by (le))",name:"90%"}],unit:"s",type:"line"})}function le(){return c.a.createElement(m.w,null,c.a.createElement(s.a,null,c.a.createElement(n.a,null,c.a.createElement(r.a,{span:18},c.a.createElement(ne,null),c.a.createElement(re,null),c.a.createElement(Z,null),c.a.createElement(ae,null)),c.a.createElement(r.a,{span:6},c.a.createElement(Y,null),c.a.createElement(B,null)))))}}}]);
//# sourceMappingURL=app_overview.6127d0a9.chunk.js.map